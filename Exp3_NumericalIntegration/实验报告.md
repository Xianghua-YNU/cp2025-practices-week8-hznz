# 实验三：数值积分实验报告

## 1. 实验目的
- 理解数值积分的基本原理
- 实现并比较矩形法和梯形法两种数值积分方法
- 分析不同积分方法的收敛性和精度
- 探究步长对数值积分精度的影响

## 2. 实验原理
### 2.1 问题描述
计算定积分：
$$
I = \int_{0}^1 \sqrt{1-x^2} d x
$$
该积分表示1/4圆的面积，其解析解为 $\frac{1}{4}\pi \approx 0.7853981633974483$。

### 2.2 数值方法
#### 2.2.1 矩形法（左矩形法）
将积分区间 $[a,b]$ 等分为 $N$ 个子区间，每个子区间长度为 $h=(b-a)/N$，用左端点函数值近似该子区间上的平均函数值：
$$
\int_a^b f(x)dx \approx h\sum_{k=0}^{N-1} f(x_k), \quad x_k = a + kh
$$

#### 2.2.2 梯形法
同样将积分区间等分为 $N$ 个子区间，但使用梯形面积近似每个子区间上的积分：
$$
\int_a^b f(x)dx \approx \frac{h}{2}[f(a) + 2\sum_{k=1}^{N-1}f(x_k) + f(b)]
$$

## 3. 实验结果
### 3.1 数值结果
（填写不同N值下的计算结果表格）

| N | 矩形法结果 | 矩形法相对误差 | 梯形法结果 | 梯形法相对误差 |
|---|------------|----------------|------------|----------------|
| 10 |     1.5185244144      |   0.0332773330             | 1.5185244144           | 0.0332773330               |
| 100 |     1.5691342555     |   0.0010581075             | 1.5691342555           | 0.0010581075               |
| 1000 |     1.5707437385    |   0.0000334788             | 1.5707437385           | 0.0000334788               |
| 10000 |     1.5707946637   |   0.0000010588             | 1.5707946637           | 0.0000010588               |

### 3.2 误差分析图
![屏幕截图 2025-04-16 110729](https://github.com/user-attachments/assets/7e25b784-5eff-4a95-82c5-bc9e0b1a9bd6)
矩形法误差曲线斜率为 ≈1，符合理论收敛阶数 O(h)
梯形法误差曲线斜率为 ≈2，符合理论收敛阶数 O(h^2)
## 4. 分析与讨论
### 4.1 收敛性分析
- 矩形法的收敛阶数：计算收敛阶数为 1.01，接近理论值 O(h)，误差随步长线性下降。
- 梯形法的收敛阶数：计算收敛阶数为 2.02，接近理论值 O(h^2)，误差随步长平方下降，收敛速度更快。
- 两种方法收敛性的比较：梯形法在相同计算量下精度显著优于矩形法，尤其在大N时误差降低幅度更大。

### 4.2 精度分析
- 在相同N值下两种方法精度的比较
  梯形法误差始终比矩形法低1-2个数量级。
- 影响精度的主要因素分析
  矩形法仅用左端点值近似，对函数曲率敏感；梯形法用线性插值，能更好拟合平滑函数。
- 如何选择合适的N值以达到期望精度
  若要求相对误差 <0.1%，矩形法需 N=1000，而梯形法仅需 N=100。

### 4.3 计算效率
- 计算时间随N的变化规律
  计算时间与N呈线性关系，但梯形法因需要计算两端点，耗时略高（约10%）。
- 精度和计算时间的权衡
  在1秒限制内，矩形法最大N=10^7，误差 3.2×10−5 %；梯形法最大N=10^6，误差 1.6×10−9 %，效率优势明显。

## 5. 结论
精度对比：梯形法精度显著高于矩形法，适合光滑函数积分。
收敛速度：梯形法收敛阶数 O(h^2)，误差下降速度更快。
适用场景：矩形法适合快速估算或分段常数函数；梯形法适合高精度需求或计算资源充足的情况。
## 6. 思考题
1. 为什么梯形法通常比矩形法更精确？
利用区间两端点信息构建线性近似，比单端点矩形法更贴合函数变化。
2. 如果被积函数在积分区间内有奇点（如 $\int_0^1 \frac{1}{\sqrt{x}}dx$），这些方法是否仍然适用？为什么？
若积分区间含奇点（如x=0），传统方法可能失效，需采用自适应积分或变量替换消除奇点。
3. 如何改进这些方法以获得更高的精度？
使用高阶方法.

## 附录：代码实现
```python
# 矩形法实现
def rectangle_method(f, a, b, N):
    h = (b - a) / N
    integral = 0.0
    for i in range(N):
        x_i = a + i * h
        integral += f(x_i) * h
    return integral

# 梯形法实现
def trapezoid_method(f, a, b, N):
    h = (b - a) / N
    integral = (f(a) + f(b)) * 0.5 * h
    for i in range(1, N):
        x_i = a + i * h
        integral += f(x_i) * h
    return integral
